# -*- coding: utf-8 -*-
"""
Created on Tue Dec  2 15:27:11 2025

@author: Nikola Anđelić
"""

from sklearn.model_selection import RandomizedSearchCV
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_iris
from scipy.stats import randint, uniform

# Load dataset
X, y = load_iris(return_X_y=True)

# Define distribution-based search space
param_dist = {
    'n_estimators': randint(50, 300),
    'max_depth': [None, 5, 10, 20],
    'min_samples_split': randint(2, 20),
    'min_samples_leaf': randint(1, 10)
}

# Configure randomized search
random_search = RandomizedSearchCV(
    estimator=RandomForestClassifier(random_state=42),
    param_distributions=param_dist,
    n_iter=20,
    cv=3,
    scoring="accuracy",
    random_state=42,
    n_jobs=-1
)

# Run the search
random_search.fit(X, y)

# Show results
print("Best parameters:", random_search.best_params_)
print("Best score:", random_search.best_score_)
